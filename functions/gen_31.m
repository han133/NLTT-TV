function [A,b]=gen_31(x,mask)
[m,n,s] = size(x);
C       = zeros(m,n,s);
for i = 1:s
    C(:,:,i) = sparse(mask(:,:,i));
end
C1 = diag(reshape(sparse(C(:,:,1)),m*n,1));
C2 = diag(reshape(sparse(C(:,:,2)),m*n,1));
C3 = diag(reshape(sparse(C(:,:,3)),m*n,1));
C4 = diag(reshape(sparse(C(:,:,4)),m*n,1));
C5 = diag(reshape(sparse(C(:,:,5)),m*n,1));
C6 = diag(reshape(sparse(C(:,:,6)),m*n,1));
C7 = diag(reshape(sparse(C(:,:,7)),m*n,1));
C8 = diag(reshape(sparse(C(:,:,8)),m*n,1));
C9 = diag(reshape(sparse(C(:,:,9)),m*n,1));
C10 = diag(reshape(sparse(C(:,:,10)),m*n,1));
C11 = diag(reshape(sparse(C(:,:,11)),m*n,1));
C12 = diag(reshape(sparse(C(:,:,12)),m*n,1));
C13 = diag(reshape(sparse(C(:,:,13)),m*n,1));
C14 = diag(reshape(sparse(C(:,:,14)),m*n,1));
C15 = diag(reshape(sparse(C(:,:,15)),m*n,1));
C16 = diag(reshape(sparse(C(:,:,16)),m*n,1));
C17 = diag(reshape(sparse(C(:,:,17)),m*n,1));
C18 = diag(reshape(sparse(C(:,:,18)),m*n,1));
C19 = diag(reshape(sparse(C(:,:,19)),m*n,1));
C20 = diag(reshape(sparse(C(:,:,20)),m*n,1));
C21 = diag(reshape(sparse(C(:,:,21)),m*n,1));
C22 = diag(reshape(sparse(C(:,:,22)),m*n,1));
C23 = diag(reshape(sparse(C(:,:,23)),m*n,1));
C24 = diag(reshape(sparse(C(:,:,24)),m*n,1));
C25 = diag(reshape(sparse(C(:,:,25)),m*n,1));
C26 = diag(reshape(sparse(C(:,:,26)),m*n,1));
C27 = diag(reshape(sparse(C(:,:,27)),m*n,1));
C28 = diag(reshape(sparse(C(:,:,28)),m*n,1));
C29 = diag(reshape(sparse(C(:,:,29)),m*n,1));
C30 = diag(reshape(sparse(C(:,:,30)),m*n,1));
C31 = diag(reshape(sparse(C(:,:,31)),m*n,1));
A = [C1,C2,C3,C4,C5,C6,C7,C8,C9,C10,C11,C12,C13,C14,C15,C16,C17,C18,C19,C20,C21,C22,C23,C24,C25,C26,C27,C28,C29,C30,C31];
b = A*x(:);
end